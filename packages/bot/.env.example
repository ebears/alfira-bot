# -----------------------------------------------
# API + Bot Configuration
# -----------------------------------------------
# Copy this file to .env and fill in all values before running.

# Port the Express API listens on.
PORT=3001

# PostgreSQL credentials — used by docker-compose.prod.yml.
# Change these before deploying. The DATABASE_URL below is constructed
# from these values inside docker-compose.prod.yml at startup.
POSTGRES_USER=botuser
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD
POSTGRES_DB=musicbot

# PostgreSQL connection string.
# - For local dev (docker-compose.yml): use localhost and the values above.
# - For containers (docker-compose.prod.yml): this is constructed automatically
#   from POSTGRES_* vars — you do not need to set it separately there.
DATABASE_URL=postgresql://botuser:CHANGE_ME_STRONG_PASSWORD@localhost:5432/musicbot

# -----------------------------------------------
# Discord Bot
# -----------------------------------------------
# Found in the Discord Developer Portal → your application → Bot → Token.
DISCORD_BOT_TOKEN=

# Found in the Developer Portal → General Information → Application ID.
DISCORD_CLIENT_ID=

# Right-click your server in Discord → Copy Server ID.
GUILD_ID=

# -----------------------------------------------
# Discord OAuth2
# -----------------------------------------------
# Found in the Developer Portal → General Information → Client Secret.
# Click "Reset Secret" if you haven't saved it already.
DISCORD_CLIENT_SECRET=

# Must exactly match a redirect URI you've added in the Developer Portal
# under OAuth2 → Redirects.
# - For local dev:        http://localhost:3001/auth/callback
# - For dockerised stack: http://localhost:8080/auth/callback
DISCORD_REDIRECT_URI=http://localhost:3001/auth/callback

# -----------------------------------------------
# JWT
# -----------------------------------------------
# A long random string used to sign JWTs. Generate one with:
#   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# Keep this secret. Changing it invalidates all existing sessions.
JWT_SECRET=CHANGE_ME_GENERATE_WITH_COMMAND_ABOVE

# -----------------------------------------------
# Role-based access
# -----------------------------------------------
# Comma-separated list of Discord role IDs that grant admin access.
# Right-click a role in Server Settings → Roles → Copy Role ID.
# Anyone in the server who doesn't have one of these roles is a member.
ADMIN_ROLE_IDS=

WEB_UI_ORIGIN=http://localhost:5173

# IP of the machine running these Docker containers (your Docker host)
# Used to bind the port to just the LAN interface
DOCKER_HOST_IP=192.168.1.x

# IP of the machine running Caddy
# Used so Express trusts X-Forwarded-For only from Caddy
TRUSTED_PROXY_IP=192.168.1.x
